<div class="user-profile-container">
  <mat-card class="profile-card">
    <mat-card-header>
      <mat-card-title>My Profile</mat-card-title>
      <button mat-icon-button (click)="toggleEditMode()" class="edit-btn">
        <mat-icon>{{ isEditMode ? 'close' : 'edit' }}</mat-icon>
      </button>
    </mat-card-header>

    <mat-card-content *ngIf="!isLoading && userProfile">
      <div class="profile-header">
        <!-- Avatar Section -->
        <div class="avatar-section">
          <div class="avatar">
            <img *ngIf="userProfile.avatarUrl" [src]="userProfile.avatarUrl" alt="Profile" />
            <mat-icon *ngIf="!userProfile.avatarUrl">account_circle</mat-icon>
          </div>
        </div>

        <!-- Basic Info (Display Mode) -->
        <div class="basic-info" *ngIf="!isEditMode">
          <h2>{{ userProfile.firstName }} {{ userProfile.lastName }}</h2>
          <p class="email">{{ userProfile.email }}</p>
          <span class="role-badge" [ngClass]="currentUserRole.toLowerCase()">
            {{ currentUserRole === 'SELLER' ? 'Seller Account' : 'Customer Account' }}
          </span>
        </div>

        <!-- Edit Form -->
        <form *ngIf="isEditMode" [formGroup]="profileForm" class="edit-form">
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>First Name</mat-label>
            <input matInput formControlName="firstName" />
          </mat-form-field>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Last Name</mat-label>
            <input matInput formControlName="lastName" />
          </mat-form-field>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Email</mat-label>
            <input matInput formControlName="email" type="email" />
          </mat-form-field>
        </form>
      </div>

      <!-- Action Buttons -->
      <div class="actions">
        <button *ngIf="!isEditMode" mat-raised-button color="primary" (click)="toggleEditMode()">
          <mat-icon>edit</mat-icon>
          Edit Profile
        </button>
        <button *ngIf="isEditMode" mat-raised-button color="accent" (click)="saveProfile()" [disabled]="profileForm.invalid || isLoading">
          <mat-icon>save</mat-icon>
          Save
        </button>
        <button *ngIf="isEditMode" mat-raised-button (click)="toggleEditMode()">
          <mat-icon>close</mat-icon>
          Cancel
        </button>
      </div>
    </mat-card-content>

    <mat-card-content *ngIf="isLoading">
      <p>Loading profile...</p>
    </mat-card-content>
  </mat-card>
</div>
